const _0x5e837e=_0x3982;function _0x3982(_0x340b06,_0x1519d9){const _0x4e1c9a=_0x7204();return _0x3982=function(_0x489e05,_0x51030f){_0x489e05=_0x489e05-0x16b;let _0x72045c=_0x4e1c9a[_0x489e05];return _0x72045c;},_0x3982(_0x340b06,_0x1519d9);}(function(_0x4cd19e,_0x3cb5db){const _0x45065b=_0x3982,_0x56a8a0=_0x4cd19e();while(!![]){try{const _0x230d9e=-parseInt(_0x45065b(0x191))/0x1*(parseInt(_0x45065b(0x188))/0x2)+parseInt(_0x45065b(0x194))/0x3+-parseInt(_0x45065b(0x198))/0x4*(parseInt(_0x45065b(0x177))/0x5)+-parseInt(_0x45065b(0x1ae))/0x6*(parseInt(_0x45065b(0x182))/0x7)+parseInt(_0x45065b(0x189))/0x8+parseInt(_0x45065b(0x183))/0x9+parseInt(_0x45065b(0x171))/0xa;if(_0x230d9e===_0x3cb5db)break;else _0x56a8a0['push'](_0x56a8a0['shift']());}catch(_0x42baff){_0x56a8a0['push'](_0x56a8a0['shift']());}}}(_0x7204,0xd2075));const _0x51030f=(function(){let _0x2fefa7=!![];return function(_0x278244,_0x4cd923){const _0x44b346=_0x2fefa7?function(){const _0x2b236d=_0x3982;if(_0x4cd923){const _0x2fc9ad=_0x4cd923[_0x2b236d(0x181)](_0x278244,arguments);return _0x4cd923=null,_0x2fc9ad;}}:function(){};return _0x2fefa7=![],_0x44b346;};}()),_0x489e05=_0x51030f(this,function(){const _0x329f5b=_0x3982;return _0x489e05[_0x329f5b(0x190)]()[_0x329f5b(0x19e)]('(((.+)+)+)+$')[_0x329f5b(0x190)]()[_0x329f5b(0x1a6)](_0x489e05)['search'](_0x329f5b(0x1b5));});_0x489e05();'use strict';var __createBinding=this&&this[_0x5e837e(0x1ac)]||(Object[_0x5e837e(0x17d)]?function(_0x3c6f09,_0x9cf0d6,_0x354f71,_0x4ae3e1){const _0x5954a2=_0x5e837e;if(_0x4ae3e1===undefined)_0x4ae3e1=_0x354f71;var _0x3f47d0=Object['getOwnPropertyDescriptor'](_0x9cf0d6,_0x354f71);(!_0x3f47d0||('get'in _0x3f47d0?!_0x9cf0d6[_0x5954a2(0x19a)]:_0x3f47d0[_0x5954a2(0x19f)]||_0x3f47d0[_0x5954a2(0x19b)]))&&(_0x3f47d0={'enumerable':!![],'get':function(){return _0x9cf0d6[_0x354f71];}}),Object[_0x5954a2(0x1a8)](_0x3c6f09,_0x4ae3e1,_0x3f47d0);}:function(_0x35379f,_0x3fea10,_0x945356,_0x9fe2d5){if(_0x9fe2d5===undefined)_0x9fe2d5=_0x945356;_0x35379f[_0x9fe2d5]=_0x3fea10[_0x945356];}),__setModuleDefault=this&&this[_0x5e837e(0x18c)]||(Object[_0x5e837e(0x17d)]?function(_0x460f95,_0x32115c){const _0x1f34db=_0x5e837e;Object[_0x1f34db(0x1a8)](_0x460f95,_0x1f34db(0x179),{'enumerable':!![],'value':_0x32115c});}:function(_0x1ad069,_0x3ce82e){const _0x2c68a1=_0x5e837e;_0x1ad069[_0x2c68a1(0x179)]=_0x3ce82e;}),__importStar=this&&this[_0x5e837e(0x1a0)]||function(_0x5b7c87){const _0x264a43=_0x5e837e;if(_0x5b7c87&&_0x5b7c87['__esModule'])return _0x5b7c87;var _0x1ac7d3={};if(_0x5b7c87!=null){for(var _0xb722c7 in _0x5b7c87)if(_0xb722c7!=='default'&&Object[_0x264a43(0x17a)][_0x264a43(0x173)]['call'](_0x5b7c87,_0xb722c7))__createBinding(_0x1ac7d3,_0x5b7c87,_0xb722c7);}return __setModuleDefault(_0x1ac7d3,_0x5b7c87),_0x1ac7d3;},__importDefault=this&&this[_0x5e837e(0x197)]||function(_0x42da11){const _0x4b57f8=_0x5e837e;return _0x42da11&&_0x42da11[_0x4b57f8(0x19a)]?_0x42da11:{'default':_0x42da11};};Object[_0x5e837e(0x1a8)](exports,_0x5e837e(0x19a),{'value':!![]}),exports[_0x5e837e(0x180)]=void 0x0;const CryptoJS=__importStar(require('crypto-js')),http_errors_1=__importDefault(require('http-errors')),lodash_1=require('lodash');function _0x7204(){const _0x2278ec=['__Host_alt.csrftoken','HEAD','760071yPCxXS','AES','secret','__importDefault','3839392eSmrrw','socket','__esModule','configurable','split','method','search','writable','__importStar','headers','GET','stringify','parse','csrf','constructor','Cookie-parser\x20module\x20is\x20required\x20for\x20ALTCsrf\x20to\x20work\x20properly.','defineProperty','signedCookies','x-forwarded-for','valide','__createBinding','ValiteexpecificToken','54vcjhdQ','expecificToken','Hex','enc','cookies','sender','ignoredRoutes','(((.+)+)+)+$','signed','ProtectionMiddleware','encrypt','join','Utf8','defaultsDeep','Custom','18389900icgdtm','lax','hasOwnProperty','ALTHtml/json','decrypt','OPTIONS','5LceYjk','SHA256','default','prototype','has','ignores','create','InvalidCsrfError','ValiteToken','ALTCsrf','apply','872571qnrOEk','14084973TpELqj','name','remoteAddress','Error\x20invalid\x20csrf\x20token','error','184454oeOnaE','3868872PCnhwt','ignoredMethods','To\x20use\x20the\x20Custom\x20Response\x20it\x20is\x20necessary\x20to\x20call\x20new\x20ALTCsrf({csrf:{\x20sender:\x22Custom\x22,Custom:(req,res,next(optional))\x20=>\x20{res.send(\x22exemple\x22)}}})\x20in\x20the\x20creation\x20of\x20the\x20class,\x20returning\x20the\x20default\x20template\x20\x22http-error\x22.','__setModuleDefault','conf','http-error','cookie','toString','13fQBiSZ'];_0x7204=function(){return _0x2278ec;};return _0x7204();}class ALTCsrf{[_0x5e837e(0x18d)];['ignoredMethods'];[_0x5e837e(0x1b4)];constructor(_0x25446b){const _0x53432d=_0x5e837e,_0x36be74={'secret':'','ignores':{'methods':[_0x53432d(0x1a2),_0x53432d(0x193),_0x53432d(0x176)],'routes':['']},'csrf':{'name':_0x53432d(0x192),'sender':'ALTHtml/json'},'cookie':{'sameSite':_0x53432d(0x172),'path':'/','secure':!![]}},_0x280a05=(0x0,lodash_1[_0x53432d(0x16f)])(_0x25446b,_0x36be74);this[_0x53432d(0x18d)]={'secret':_0x280a05[_0x53432d(0x196)],'csrf':_0x280a05[_0x53432d(0x1a5)],'cookie':_0x280a05[_0x53432d(0x18f)]},this[_0x53432d(0x18a)]=new Set(_0x280a05[_0x53432d(0x17c)]['methods']),this[_0x53432d(0x1b4)]=new Set(_0x280a05['ignores']['routes']);}get['InvalidCsrfError'](){const _0x26dc46=_0x5e837e;return(0x0,http_errors_1['default'])(0x193,_0x26dc46(0x186));}[_0x5e837e(0x17d)](..._0x340ebc){const _0x7787a0=_0x5e837e,_0x190f20=CryptoJS['SHA256'](_0x340ebc?_0x340ebc[_0x7787a0(0x190)]():''+this[_0x7787a0(0x18d)][_0x7787a0(0x196)])[_0x7787a0(0x190)](),_0x2590c5=CryptoJS[_0x7787a0(0x195)][_0x7787a0(0x16c)](_0x190f20+_0x340ebc?_0x340ebc[_0x7787a0(0x190)]():'',this[_0x7787a0(0x18d)][_0x7787a0(0x196)])[_0x7787a0(0x190)](),_0x2a101b=CryptoJS['enc']['Hex'][_0x7787a0(0x1a3)](CryptoJS[_0x7787a0(0x1b1)][_0x7787a0(0x16e)][_0x7787a0(0x1a4)](_0x2590c5));return _0x2a101b+'&'+_0x190f20;}[_0x5e837e(0x1ab)](_0x3c5a7b,..._0x42290f){const _0x2fa372=_0x5e837e;if(!_0x3c5a7b)return![];const [_0x23f581,_0x544d1f]=_0x3c5a7b[_0x2fa372(0x19c)]('&'),_0x519b70=CryptoJS[_0x2fa372(0x178)](_0x42290f?_0x42290f[_0x2fa372(0x190)]():''+this[_0x2fa372(0x18d)][_0x2fa372(0x196)])[_0x2fa372(0x190)](),_0x44039d=CryptoJS[_0x2fa372(0x195)][_0x2fa372(0x175)](CryptoJS[_0x2fa372(0x1b1)][_0x2fa372(0x16e)][_0x2fa372(0x1a3)](CryptoJS[_0x2fa372(0x1b1)][_0x2fa372(0x1b0)][_0x2fa372(0x1a4)](_0x23f581)),this[_0x2fa372(0x18d)]['secret'])['toString'](CryptoJS['enc'][_0x2fa372(0x16e)]);if(_0x544d1f!==_0x519b70)return![];if(_0x44039d!==(_0x42290f?_0x42290f[_0x2fa372(0x190)]():''+this['conf'][_0x2fa372(0x196)]))return![];return!![];}[_0x5e837e(0x16b)](){return(_0x50649f,_0x1dd9f8,_0x38f701)=>{const _0x17f4a0=_0x3982;if(!_0x1dd9f8[_0x17f4a0(0x18f)])throw new Error(_0x17f4a0(0x1a7));const _0x1fc262=this['conf']?.[_0x17f4a0(0x18f)]?.[_0x17f4a0(0x1b6)]?_0x50649f['signedCookies'][this['conf'][_0x17f4a0(0x1a5)]['name']]:_0x50649f['cookies'][this[_0x17f4a0(0x18d)]['csrf'][_0x17f4a0(0x184)]];if(this['ignoredRoutes'][_0x17f4a0(0x17b)](_0x50649f['originalUrl']))return _0x38f701();else{if(this[_0x17f4a0(0x18a)][_0x17f4a0(0x17b)](_0x50649f[_0x17f4a0(0x19d)]))return _0x38f701();else{if(this[_0x17f4a0(0x1ab)](_0x1fc262,''+(_0x50649f[_0x17f4a0(0x1a1)]['x-forwarded-for']??_0x50649f['ip']??_0x50649f[_0x17f4a0(0x199)][_0x17f4a0(0x185)])))return _0x38f701();else{_0x1dd9f8['clearCookie'](this[_0x17f4a0(0x18d)]['cookie']?.['signed']?_0x50649f[_0x17f4a0(0x1a9)][this[_0x17f4a0(0x18d)]['csrf'][_0x17f4a0(0x184)]]:_0x50649f[_0x17f4a0(0x1b2)][this[_0x17f4a0(0x18d)][_0x17f4a0(0x1a5)][_0x17f4a0(0x184)]]);switch(this[_0x17f4a0(0x18d)][_0x17f4a0(0x1a5)]?.[_0x17f4a0(0x1b3)]){case _0x17f4a0(0x174):return _0x38f701(this[_0x17f4a0(0x17e)]);case _0x17f4a0(0x18e):return _0x38f701(this['InvalidCsrfError']);case'Custom':if(this['conf'][_0x17f4a0(0x1a5)][_0x17f4a0(0x170)])return this[_0x17f4a0(0x18d)]['csrf'][_0x17f4a0(0x170)](_0x50649f,_0x1dd9f8,_0x38f701);else return console[_0x17f4a0(0x187)](_0x17f4a0(0x18b)),_0x38f701(this['InvalidCsrfError']);default:return _0x38f701(this[_0x17f4a0(0x17e)]);}}}}};}['CreateToken'](_0x292d26,_0x4ad7a0,_0x55d6a0=![]){const _0xc40337=_0x5e837e;if(!_0x4ad7a0['cookie'])throw new Error(_0xc40337(0x1a7));const _0x56d62f=this[_0xc40337(0x18d)][_0xc40337(0x18f)]&&this['conf']['cookie']['signed']?_0x292d26[_0xc40337(0x1a9)][this[_0xc40337(0x18d)][_0xc40337(0x1a5)]['name']]:_0x292d26[_0xc40337(0x1b2)][this[_0xc40337(0x18d)][_0xc40337(0x1a5)][_0xc40337(0x184)]],_0x4327e5=this[_0xc40337(0x17d)](''+(_0x292d26[_0xc40337(0x1a1)][_0xc40337(0x1aa)]??_0x292d26['ip']??_0x292d26[_0xc40337(0x199)][_0xc40337(0x185)]));if(_0x56d62f&&!_0x55d6a0)return _0x56d62f;return _0x4ad7a0['cookie'](this['conf'][_0xc40337(0x1a5)][_0xc40337(0x184)],_0x4327e5,{'httpOnly':!![],...this['conf']['cookie']}),_0x4327e5;}[_0x5e837e(0x17f)](_0x191332){const _0x4550d9=_0x5e837e,_0x3e9762=this[_0x4550d9(0x18d)][_0x4550d9(0x18f)]&&this[_0x4550d9(0x18d)]['cookie'][_0x4550d9(0x1b6)]?_0x191332['signedCookies'][this[_0x4550d9(0x18d)]['csrf'][_0x4550d9(0x184)]]:_0x191332['cookies'][this[_0x4550d9(0x18d)]['csrf'][_0x4550d9(0x184)]];return this[_0x4550d9(0x1ab)](_0x3e9762,''+(_0x191332['headers']['x-forwarded-for']??_0x191332['ip']??_0x191332[_0x4550d9(0x199)]['remoteAddress']));}[_0x5e837e(0x1af)](_0x230e44,_0x33e402,..._0x55b622){const _0x59c71b=_0x5e837e;if(!_0x230e44[_0x59c71b(0x18f)])throw new Error(_0x59c71b(0x1a7));const _0x5ea991=this[_0x59c71b(0x17d)](_0x55b622[_0x59c71b(0x16d)]('|'));return _0x230e44[_0x59c71b(0x18f)](_0x33e402,_0x5ea991,{'httpOnly':!![],...this[_0x59c71b(0x18d)][_0x59c71b(0x18f)]}),_0x5ea991;}[_0x5e837e(0x1ad)](_0xe2b6d7,_0x132af5,..._0x557bd0){const _0x187fde=_0x5e837e,_0x35d43b=this['conf'][_0x187fde(0x18f)]&&this[_0x187fde(0x18d)][_0x187fde(0x18f)][_0x187fde(0x1b6)]?_0xe2b6d7[_0x187fde(0x1a9)][_0x132af5]:_0xe2b6d7[_0x187fde(0x1b2)][_0x132af5];return this[_0x187fde(0x1ab)](_0x35d43b,_0x557bd0[_0x187fde(0x16d)]('|'));}}exports[_0x5e837e(0x180)]=ALTCsrf;