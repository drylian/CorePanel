const _0x24586c=_0xd52a;function _0xd52a(_0x13a3c7,_0x5355cf){const _0x2b7953=_0xa408();return _0xd52a=function(_0x5a92f9,_0x1c5cb3){_0x5a92f9=_0x5a92f9-0x14a;let _0xa408b8=_0x2b7953[_0x5a92f9];return _0xa408b8;},_0xd52a(_0x13a3c7,_0x5355cf);}function _0xa408(){const _0x4500a5=['NotHaveNecessaryPerms','3IMskIf','type','10687452aQufFk','FutureAuthTokenChecker','X-Application-Access','signedCookies','join','headers','Cookie','toString','HaveAccess','The\x20access\x20types\x20supported\x20by\x20the\x20api\x20are\x20','\x20Token123\x22\x20','user','Guest','7nwMkyA','InvalidTokenFormat','search','defineProperty','authorization','1122enmYKJ','access','You\x20do\x20not\x20have\x20sufficient\x20permissions\x20to\x20be\x20able\x20to\x20access\x20the\x20resources\x20on\x20this\x20route','constructor','Route\x20requires\x20authorization\x20but\x20does\x20not\x20say\x20what\x20type\x20of\x20authorization\x20is\x20required.','X-Application-Refresh','11JvixYM','Token','3605688cYWpzo','length','3550992qotOWi','The\x20way\x20to\x20use\x20the\x20token\x20is\x20invalid,\x20use\x20Bearer\x20and\x20the\x20token\x20used,\x20example:\x20\x22Bearer\x20Token123\x22','permission','91022NdeKYt','Access\x20type\x20of\x20this\x20request\x20is\x20unknown,\x20please\x20try\x20again','FullAccess','push','10467wgGmcv','ClientToken','includes','Authorization','apply','13vZxhIb','This\x20route\x20does\x20not\x20allow\x20this\x20type\x20of\x20access\x20token,\x20types\x20allowed\x20','\x20and\x20','635978pYTtVW','InvalidRouteRequirements','AuthenticateTypes',',\x20example:\x20\x22','3780XoEdVd','16gPHpTd','10435yxJcDF'];_0xa408=function(){return _0x4500a5;};return _0xa408();}(function(_0x89eff0,_0x11d19c){const _0x5ccacc=_0xd52a,_0x50d4b2=_0x89eff0();while(!![]){try{const _0x1e1681=-parseInt(_0x5ccacc(0x175))/0x1*(parseInt(_0x5ccacc(0x164))/0x2)+-parseInt(_0x5ccacc(0x178))/0x3*(parseInt(_0x5ccacc(0x15f))/0x4)+-parseInt(_0x5ccacc(0x176))/0x5*(-parseInt(_0x5ccacc(0x157))/0x6)+-parseInt(_0x5ccacc(0x152))/0x7*(-parseInt(_0x5ccacc(0x161))/0x8)+parseInt(_0x5ccacc(0x168))/0x9*(parseInt(_0x5ccacc(0x174))/0xa)+-parseInt(_0x5ccacc(0x15d))/0xb*(-parseInt(_0x5ccacc(0x17a))/0xc)+-parseInt(_0x5ccacc(0x16d))/0xd*(-parseInt(_0x5ccacc(0x170))/0xe);if(_0x1e1681===_0x11d19c)break;else _0x50d4b2['push'](_0x50d4b2['shift']());}catch(_0x267d66){_0x50d4b2['push'](_0x50d4b2['shift']());}}}(_0xa408,0x8da6f));const _0x1c5cb3=(function(){let _0x4bbd5f=!![];return function(_0xef498f,_0x498edf){const _0x257dba=_0x4bbd5f?function(){const _0x109f77=_0xd52a;if(_0x498edf){const _0x51e01b=_0x498edf[_0x109f77(0x16c)](_0xef498f,arguments);return _0x498edf=null,_0x51e01b;}}:function(){};return _0x4bbd5f=![],_0x257dba;};}()),_0x5a92f9=_0x1c5cb3(this,function(){const _0x384b04=_0xd52a;return _0x5a92f9['toString']()[_0x384b04(0x154)]('(((.+)+)+)+$')[_0x384b04(0x14c)]()[_0x384b04(0x15a)](_0x5a92f9)['search']('(((.+)+)+)+$');});_0x5a92f9();'use strict';Object[_0x24586c(0x155)](exports,'__esModule',{'value':!![]}),exports[_0x24586c(0x16b)]=void 0x0;const RouterController_1=require('../RouterController');async function Authorization(_0xd8995,_0x4677a3,_0x2d43a9){const _0x48481d=_0x24586c;if(_0x2d43a9[_0x48481d(0x179)]){const _0xbb2cee=!_0xd8995[_0x48481d(0x17d)][_0x48481d(0x17c)]&&!_0xd8995['signedCookies'][_0x48481d(0x15c)];if(!_0xbb2cee&&_0xd8995[_0x48481d(0x150)]){if(_0xd8995['user'][_0x48481d(0x158)]==='User'){if(_0x2d43a9[_0x48481d(0x163)]){if(_0xd8995[_0x48481d(0x150)]['permission']<_0x2d43a9[_0x48481d(0x163)])return{'response':_0x48481d(0x159),'code':_0x48481d(0x177),'status':0x193};}if(!_0x2d43a9[_0x48481d(0x179)][_0x48481d(0x16a)](RouterController_1[_0x48481d(0x172)][_0x48481d(0x14b)])){const _0x6779af=[];for(const _0x27594a of _0x2d43a9['type']){if(RouterController_1[_0x48481d(0x172)][_0x48481d(0x14b)]!==_0x27594a&&RouterController_1[_0x48481d(0x172)]['FullAccess']!==_0x27594a)_0x6779af['push'](_0x27594a);}return{'response':'This\x20route\x20does\x20not\x20allow\x20this\x20type\x20of\x20access\x20token,\x20types\x20allowed\x20'+_0x6779af[_0x48481d(0x17e)](',\x20'),'code':'TokenTypeAccessDenied','status':0x193};}return{'response':'OK','code':_0x48481d(0x14d),'status':0xc8};}}if(_0xbb2cee&&_0xd8995[_0x48481d(0x14a)][_0x48481d(0x156)]){const _0x28611a=_0xd8995['headers'][_0x48481d(0x156)]?.['split']('\x20');if(_0x28611a[_0x48481d(0x160)]<0x2)return{'response':_0x48481d(0x162),'code':_0x48481d(0x153),'status':0x190};if(!Object['values'](RouterController_1[_0x48481d(0x172)])[_0x48481d(0x16a)](_0x28611a[0x0]))return{'response':_0x48481d(0x14e)+RouterController_1[_0x48481d(0x172)][_0x48481d(0x15e)]+_0x48481d(0x16f)+RouterController_1[_0x48481d(0x172)]['ClientToken']+_0x48481d(0x173)+RouterController_1['AuthenticateTypes'][_0x48481d(0x169)]+_0x48481d(0x14f),'code':'InvalidTypeTokenFormat','status':0x190};const [_0x3781ef,_0x266096]=_0x28611a;if(!_0x2d43a9['type'][_0x48481d(0x16a)](_0x3781ef)){const _0xdcee2=[];for(const _0x5f2aa1 of _0x2d43a9['type']){if(RouterController_1[_0x48481d(0x172)]['Cookie']!==_0x5f2aa1&&RouterController_1[_0x48481d(0x172)][_0x48481d(0x166)]!==_0x5f2aa1)_0xdcee2[_0x48481d(0x167)](_0x5f2aa1);}return{'response':_0x48481d(0x16e)+_0xdcee2[_0x48481d(0x17e)](',\x20'),'code':'TokenTypeAccessDenied','status':0x193};}const _0x228d75=_0x48481d(0x17b);}return _0x2d43a9[_0x48481d(0x179)]['includes'](RouterController_1[_0x48481d(0x172)][_0x48481d(0x151)])?{'response':'OK','code':_0x48481d(0x14d),'status':0xc8}:{'response':_0x48481d(0x165),'code':'AccessTypeNotFound','status':0x191};}return{'response':_0x48481d(0x15b),'code':_0x48481d(0x171),'status':0x1f4};}exports[_0x24586c(0x16b)]=Authorization;